/******************** (C) COPYRIGHT 2011 野火嵌入式开发工作室 ********************
 * 文件名       ：main.c
 * 描述         ：GPIO操作实验
 *
 * 实验平台     ：野火kinetis开发板
 * 库版本       ：
 * 嵌入系统     ：
 *
 * 作者         ：野火嵌入式开发工作室
 * 淘宝店       ：http://firestm32.taobao.com
 * 技术支持论坛 ：http://www.ourdev.cn/bbs/bbs_list.jsp?bbs_id=1008
**********************************************************************************/	



#include "common.h"
#include "include.h"


      //这里选择 0 或 1 来切换编译各个个不同的main函数 ，这里共五个main函数，靠宏定义决定编译哪个
            //0表示屏蔽这段代码


/*************************************************************************
*                             野火嵌入式开发工作室
*                         51编程风格的GPIO实验输出测试
*
*  实验说明：野火GPIO实验，利用LED来显示电平高低
*
*  实验操作：无
*
*  实验效果：LED0每隔500ms
*
*  实验目的：明白如何用51编程风格来设置IO口电平
*
*  修改时间：2012-2-28     已测试
*
*  备    注：野火Kinetis开发板的 LED0~3 ，分别接PTD15~PTD12 ，低电平点亮
*************************************************************************/
/*unsigned char a;
void  main(void)
{
  unsigned int i ,j;//j;
  unsigned char image[40][40]=
            {
                  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1},
                  
                  {1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,1,1,1,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1},
                  {1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1},
                  {1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1},
                  {1,1,1,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1},
                  {1,1,1,1,1,1,0,0,1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1},
                  {1,1,1,1,1,0,0,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1},
                  {1,1,1,1,1,1,0,0,1,1,0,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1},
                  
                  {1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1},
                  {1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1},
                  {1,1,1,1,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,0,0,0,0,1},
                  {1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,1,1,1,1,0,0,0,0,1},
                  {1,1,1,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,1},
                  {1,1,0,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,1},
                  {1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1},
                  {1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,0,0,0,0,1},
                  
                  {1,1,0,0,0,1,1,0,1,1,0,1,0,1,1,1,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,0,0,0,0,1},
                  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1},
                  {1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1},
                  {0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
                  {0,0,0,0,0,0,1,1,1,0,1,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
                  {0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
                  {0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
                  {0,0,0,0,0,0,0,1,0,0,1,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
                  
                  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1},
                  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
                  {1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0},
                  {1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0},
                  {1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,0,1,0},
                  {1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,1,0,0},
                  {1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,1,0,0,1,0,0,1,1,1,0,0,0,0,1,0,1,0,1,0},
                  {1,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,1,1,0,1,1,1,0,0,1,0,0,0,0,1,0,1,0}  
            };
  
        exti_init(PORTA, 26, rising_down);
        gpio_init(PORTA, 27, GPO, 1);
        gpio_init(PORTD, 14, GPO, 0);
        gpio_init(PORTD, 15, GPO, 0);
          EnableInterrupts;
        i=50000;
        while(i--);
        LCD_init(); //初始化液晶    
	LCD_clear();
	LCD_set_XY(0,0);
 	while(1)  
	{
          if(a)
          {
                LCD_clear();
 		LCD_write_english_string(0,0," Welcome to  ");
 		LCD_write_english_string(0,1," Amy  studio ");
 		LCD_write_english_string(0,2,"amy-studio.com");
 		LCD_write_english_string(0,3," Nokia5110 LCD");
		LCD_write_chinese_string(12,4,12,4,0,5);
               
            
                
          }
               
           else  
           {
             LCD_clear();
             
                LCD_draw_pixel(image,40,40,0,20,0);
              for(j=0;j<50;j++)
              { i=500000;
                    while(i--);
              }
                              
           }
          GPIO_TURN(PORTA,27);
	}	  


}*/

                        
//全局变量添加                        
   u32 i = 0,j = 0;
   u8 image[40][40] =
            {
                  {158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,98,158,98,158,98,158,98,158,98,158,98,158,98,158,98,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,158,158,158,98,98,158,158,98,98,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,158,98,98,98,98,98,158,158,158,158,98,98,98,98,158,158,158,158,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158},
                  
                  {158,158,158,158,158,158,158,158,98,98,98,158,158,158,158,158,98,98,98,158,98,98,158,158,158,158,158,98,98,98,98,98,98,98,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,158,98,158,158,158,158,158,158,98,98,98,158,158,158,98,98,158,158,158,158,158,98,98,98,98,98,98,158,158,158,158,158,158},
                  {158,158,158,158,158,158,158,98,98,158,158,158,158,158,98,98,98,158,158,158,158,158,98,158,158,158,158,158,158,98,98,98,98,98,98,158,158,158,158,158},
                  {158,158,158,158,158,158,158,98,98,98,158,158,158,98,98,98,158,98,158,158,158,158,158,98,158,158,158,158,158,158,98,98,98,98,98,98,158,158,158,158},
                  {158,158,158,158,158,158,98,98,98,98,158,158,158,98,98,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,158,158,158},
                  {158,158,158,158,158,158,98,98,158,158,98,98,98,158,158,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,158,158,158},
                  {158,158,158,158,158,98,98,158,158,158,98,98,98,158,158,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,158,158},
                  {158,158,158,158,158,158,98,98,158,158,98,98,98,98,98,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,158,158},
                  
                  {158,158,158,158,158,158,98,98,98,158,98,98,98,98,98,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,158},
                  {158,158,158,158,98,98,158,158,98,98,98,98,98,98,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,158,158},
                  {158,158,158,158,98,158,158,158,158,98,98,98,158,158,158,158,98,98,158,158,158,158,158,158,158,158,158,158,158,158,98,98,158,158,158,98,98,98,98,158},
                  {158,158,158,98,158,158,158,158,158,158,158,98,98,98,98,98,98,98,98,98,98,158,158,158,158,158,158,158,158,98,98,158,158,158,158,98,98,98,98,158},
                  {158,158,158,98,158,158,158,158,158,158,158,158,158,98,98,98,158,158,158,158,158,98,98,158,158,158,158,158,158,98,158,158,158,158,158,98,98,98,98,158},
                  {158,158,98,158,158,158,158,158,158,158,158,158,98,98,158,158,158,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,158,158,158,98,98,98,158},
                  {158,158,98,98,158,158,158,158,158,158,158,158,98,158,158,158,158,158,158,158,158,158,158,158,158,158,158,98,98,98,98,98,98,158,158,158,98,98,98,158},
                  {158,158,98,98,158,158,158,158,158,158,158,158,98,158,158,158,158,98,158,158,158,158,158,158,158,158,98,98,98,98,98,158,158,158,158,98,98,98,98,158},
                  
                  {158,158,98,98,98,158,158,98,158,158,98,158,98,158,158,158,98,98,98,98,158,158,158,158,158,158,98,98,98,98,98,158,158,158,158,98,98,98,98,158},
                  {158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,158,158,98,98,98,98,98,98,158,158,158,158,158,98,98,98,98,158},
                  {158,98,98,98,98,98,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,158,98,98,98,98,98,158},
                  {98,98,98,98,98,98,158,158,158,98,98,98,98,98,98,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158},
                  {98,98,98,98,98,98,158,158,158,98,158,98,158,158,98,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158},
                  {98,98,98,98,98,98,98,98,158,98,158,98,98,98,98,158,98,98,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158},
                  {98,98,98,98,98,98,158,98,98,98,98,98,98,98,98,98,98,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158},
                  {98,98,98,98,98,98,98,158,98,98,158,98,158,158,98,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158},
                  
                  {158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158},
                  {158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158},
                  {158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,98,98},
                  {158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,98,98,98,98,98,158,98,158,98},
                  {158,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,158,98,98,158,98,158,98,158,98},
                  {158,158,158,158,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,158,98,98,158,98,158,98,158,98,98},
                  {158,158,158,98,98,98,98,98,98,98,98,98,98,98,158,98,98,158,158,98,158,158,98,98,158,98,98,158,158,158,98,98,98,98,158,98,158,98,158,98},
                  {158,158,158,98,98,158,98,98,158,98,98,158,98,98,158,98,158,158,158,98,158,158,98,158,158,98,158,158,158,98,98,158,98,98,98,98,158,98,158,98}  
            }, finish_flag = 0;

/***************************2013年7月9日添加程序**************************************
*
*
*
*
************************************************************************************/
void main()
{
  u8 I;
  
  uart_init(UART1,115200); 
  
  //初始化
  DisableInterrupts;
  LCD_init();
  LCD_draw_pixel(image,40,40,100,0,0);  
  Light_init;
  gpio_init(PORTA,10,GPO,1);
  for(I=0;I<8;I++)
  gpio_init(PORTD,I,GPI,1);
  LCD_clear();
  LCD_write_num(0,0,0);
  LCD_write_num(0,1,0);
  exti_init(PORTE, 0, rising_down);
  exti_init(PORTD, 10, rising_down);
  enable_irq(91);//使能E口中断，E0场中断
  disable_irq(90);  //D口行中断
  EnableInterrupts;
 // DisableInterrupts;
  Light1_on;
  Light2_on;
  gpio_init(PORTA, 8, GPO, 1);
  while(1)
  {
    if(finish_flag == 1)
    {
      LCD_draw_pixel(image,40,40,100,0,0);      
      enable_irq(91);
      finish_flag = 0;
    }
  }

 
}